{% extends "employees/layouts/application.html" %}


{% block js %}
<script type="text/javascript" src="/static/employees/js/select2.js"></script>
<script type="text/javascript" src="/static/employees/js/jquery.fancybox-1.3.4.pack.js"></script>
{% endblock %}


{% block styles %}
<link rel="stylesheet" type="text/css" href="/static/employees/css/select2.css" />
<link rel="stylesheet" type="text/css" href="/static/employees/css/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/static/employees/css/ui-lightness/jquery-ui-1.8.21.custom.css" />
<link rel="stylesheet" type="text/css" href="/static/employees/css/jquery.fancybox-1.3.4.css" media="screen" />
{% endblock %}



{% block content %}


<header class="review-header" style="height:90px;">
    <h1>Edit: <a href="/performancereview_templates/{{pp['template']['_id']}}">{{pp['template']['name']}}</a></h1>
</header>

{% if pp['error_message'] %}
    <h3 style="color:#b22222; opacity: .7">{{ pp['error_message'] }}</h3>
{% endif %}

<div id="questionblock" style="display: none">
    Question:&nbsp; <textarea class="input-xlarge" rows ="3"></textarea>
    <br/><br/>
</div>

<form action="/performancereview_templates/{{pp['template']['_id']}}/edit" method="post" class="form-horizontal" name="EditPerformanceReviewTemplate">
    <fieldset>
        Name:&nbsp;&nbsp;<input type="text" class="input-xlarge" name="name" id="name" value="{{pp['template']['name']}}" placeholder="e.g. Engineer Review"></input> 
        <br/><br/><br/>
        <div class="row show-grid">
            <div class="span6">
                <div class="reviewdisplay2" style="background-color:white">
                    <header1>Employee Questions:</header1>
                    <br/><br/><br/>
                    {% for i in range(1, pp['template']['employee_questions'].__len__()+1) %}
                        Question: &nbsp;<textarea class="input-xlarge" rows ="3" id="employee_question{{i}}" name="employee_question{{i}}">{{pp['template']['employee_questions'][i-1]}}</textarea>
                        <br/><br/>
                    {% endfor %}
                    <span id="employee_writeroot"></span>
                    <br/><br/>
                    <input type="button" class="btn" value="Add Question" id="anotherQuestion('employee')" onclick="javacript:anotherQuestion('employee')"></input>
                </div><!-- reviewdisplay2-->
            </div><!-- span6 -->

            <div class="span6">
                <div class="reviewdisplay2" style="background-color:white">
                    <header1>Manager Questions:</header1>
                    <br/><br/><br/>
                    {% for i in range(1, pp['template']['manager_questions'].__len__()+1) %}
                        Question: &nbsp;<textarea class="input-xlarge" rows ="3" id="manager_question{{i}}" name="manager_question{{i}}">{{pp['template']['manager_questions'][i-1]}}</textarea>
                        <br/><br/>
                    {% endfor %}
                    <span id="manager_writeroot"></span>
                    <br/><br/>
                    <input type="button" class="btn" value="Add Question" id="anotherQuestion('manager')" onclick="javacript:anotherQuestion('manager')"></input>
                </div><!-- reviewdisplay2-->
            </div><!-- span6 -->

        </div><!-- row show-grid -->

    </fieldset>
    <br/>       
    <input type="submit" class ="btn btn-review" style="float:right; margin-top: 40px; margin-right:10px;"></input>
</form>

<script type="text/javascript" charset="utf-8">
    var employee_counter = {{pp['template']['employee_questions'].__len__()}};
    var manager_counter = {{pp['template']['manager_questions'].__len__()}};
    function anotherQuestion(role){
        if (role == "employee") {
            employee_counter ++;
            var newQuestionBlock = document.getElementById('questionblock').cloneNode(true);
            console.log(newQuestionBlock.childNodes)
            newQuestionBlock.style.display = "block";
            questionInput = newQuestionBlock.childNodes[1]
            questionInput.name = "employee_question"+String(employee_counter);
            questionInput.id = "employee_question"+String(employee_counter);
            var insertHere = document.getElementById('employee_writeroot');
            insertHere.parentNode.insertBefore(newQuestionBlock, insertHere);
        }
        else {
            manager_counter ++;
            var newQuestionBlock = document.getElementById('questionblock').cloneNode(true);
            newQuestionBlock.style.display = "block";
            questionInput = newQuestionBlock.childNodes[1];
            questionInput.name = "manager_question"+String(manager_counter);
            questionInput.id = "manager_question"+String(manager_counter);
            var insertHere = document.getElementById('manager_writeroot');
            insertHere.parentNode.insertBefore(newQuestionBlock, insertHere);
        }
    }
</script>


{% endblock %}