{% extends "employees/layouts/application.html" %}

{% block js %}
<script type="text/javascript" src="/static/employees/js/select2.js"></script>
<script type="text/javascript" src="/static/employees/js/jquery.fancybox-1.3.4.pack.js"></script>
{% endblock %}


{% block styles %}
	<link rel="stylesheet" type="text/css" href="/static/employees/css/select2.css" />
	<link rel="stylesheet" type="text/css" href="/static/employees/css/bootstrap.css" />
	<link rel="stylesheet" type="text/css" href="/static/employees/css/ui-lightness/jquery-ui-1.8.21.custom.css" />
	<link rel="stylesheet" type="text/css" href="/static/employees/css/jquery.fancybox-1.3.4.css" media="screen" />
{% endblock %}


{% block content %}

<h1>Editing profile for <a href="/employees/{{ pp['employee']['jira_uname'] }}">{{ pp['employee']['first_name']}} {{ pp['employee']['last_name']}}</a></h1>

{% if pp['error_message'] %}
	<br/>
	<h3 style="color:red;">{{ pp['error_message'] }}</h3>
{% endif %}

<form action="" method="post" class="form-horizontal">
<input type="hidden" name="id" value="{{ pp['employee']['jira_uname'] }}" >

<div class="row show-grid">
	<div class="span6">
		
		<br/>
		<br/>
		
		<fieldset>
			
			<div class="control-group">
				<label class="control-label">First Name</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="first_name" value="{{ pp['employee']['first_name'] }}" id="first_name">
					</div><!-- controls-->
			</div><!-- control-group-->
			
			<div class="control-group">
				<label class="control-label">Last Name</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="last_name" value="{{ pp['employee']['last_name'] }}" id="last_name">
					</div><!-- controls-->
			</div><!-- control-group-->
			
			<div class="control-group">
				<label class="control-label">Title</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="title" value="{{ pp['employee']['title'] }}" id="title">
					</div><!-- controls-->
			</div><!-- control-group-->	
			
			
			<div class="control-group">
				<label class="control-label" for="textarea">Bio</label>
					<div class="controls">
						<textarea class="input-xlarge" id="bio" name="bio" rows="3">{{ pp['employee']['bio'] }}</textarea>
					</div><!-- controls-->
			</div><!-- control-group-->	
			

			<div class="control-group">
				<label class="control-label">Primary Phone Number</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="primary_phone" value="{{ pp['employee']['primary_phone'] }}" id="primary_phone">
					</div><!-- controls-->
			</div><!-- control-group-->
			
			<div class="control-group">
				<label class="control-label">Primary Phone Provider</label>
					<div class="controls">
						<select name="primary_phone_provider" class="input-xlarge" value="{{ pp['employee']['primary_phone_provider'] }}" id="primary_phone_provider">
							<option></option>
							{% for provider in ["AT&T", "Verizon", "T-Mobile","Virgin Mobile", "Sprint", "Google Voice"] %}
								<option {% if provider == pp['employee']['primary_phone_provider'] %} SELECTED {% endif %} >{{ provider }}</option>
							{% endfor %}
						</select>
					</div><!-- controls-->
			</div><!-- control-group-->
			
			<div class="control-group">
				<label class="control-label">Extension</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="extension" value="{{ pp['employee']['extension'] }}" id="extension">
					</div><!-- controls-->
			</div><!-- control-group-->
			
			<div class="control-group">
				<label class="control-label">Primary Chat</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="primary_chat" value="{{ pp['employee']['primary_chat'] }}" id="primary_chat">
					</div><!-- controls-->
			</div><!-- controls-->	

			<div class="control-group">
				<label class="control-label">Status</label>
					<div class="controls">
						<select name="employee_status" class="input-xlarge" value="{{ pp['employee']['employee_status'] }}" id="employee_status">
							<option></option>
							{% for status in pp['statuses'] %}
								<option {% if status == pp['employee']['employee_status'] %} SELECTED {% endif %} >{{ status }}</option>
							{% endfor %}
						</select>
					</div><!-- controls-->
			</div><!-- controls-->

			<div class="control-group">
				<label class="control-label">Twitter</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="twitter" value="{{ pp['employee']['twitter'] }}" id="twitter">
					</div><!-- controls-->
			</div><!-- control-group-->		

			<div class="control-group">
				<label class="control-label">Secondary Phone</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="secondary_phone" value="{{ pp['employee']['secondary_phone'] }}" id="secondary_phone">
					</div><!-- controls-->
			</div><!-- control-group-->
			
			<div class="control-group">
				<label class="control-label">Secondary Phone Provider</label>
					<div class="controls">
						<select name="secondary_phone_provider" class="input-xlarge" value="{{ pp['employee']['primary_phone_provider'] }}" id="secondary_phone_provider">
							<option></option>
							{% for provider in ["AT&T", "Verizon", "T-Mobile","Virgin Mobile", "Sprint", "Google Voice"] %}
								<option {% if provider == pp['employee']['secondary_phone_provider'] %} SELECTED {% endif %} >{{ provider }}</option>
							{% endfor %}
						</select>
					</div><!-- controls-->
			</div><!-- control-group-->
			
			<div class="control-group">
				<label class="control-label">Skype ID</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="skype_id" value="{{ pp['employee']['skype_id'] }}" id="skype_id">
					</div><!-- controls-->
			</div><!-- controls-->

			<div class="control-group">
				<label class="control-label">Stackoverflow ID</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="stackoverflow_id" value="{{ pp['employee']['stackoverflow_id'] }}" id="stackoverflow_id">
					</div><!-- controls-->
			</div><!-- controls-->
			
			<div class="control-group">
				<label class="control-label">Intercall Code</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="intercall_code" value="{{ pp['employee']['intercall_code'] }}" id="intercall_code">
					</div><!-- controls-->
			</div><!-- controls-->

			<div class="control-group">
				<label class="control-label">Intercall Pin</label>
					<div class="controls">
						<input type="text" class="input-xlarge" name="intercall_pin" value="{{ pp['employee']['intercall_pin'] }}" id="intercall_pin">
					</div><!-- controls-->
			</div><!-- controls-->
			
		</fieldset>
	</div><!-- span6 -->

	<div class="span6">

		<fieldset>

			<div class="control-group">
				<label class="control-label">Profile image:</label>
					<div class="controls">
						<div class="employee-image">
							<img src="/profileimage/{{ pp['employee']['jira_uname'] }}" onerror="ImgError(this, '{{pp["gravatar_hash"]}}');">
						</div><!-- /.employee-image -->
						{% if pp['is_current_user'] %}
						<a href="/employees/{{ pp['employee']['jira_uname']}}/editimage" id="edit_image" >select different image</a>
						{% endif %}
					</div><!-- controls-->
			</div><!-- control-group-->
			
			<div class="control-group">
				<label class="control-label">Email Addresses:</label>
					<div class="controls">
						{{ ', '.join(pp['employee']['email_addresses']) }}
						<br/>
						{% if pp['is_current_user'] %}
						<a href="/employees/{{ pp['employee']['jira_uname']}}/editemails" id="edit_email" >edit email addresses</a>
						{% endif %}
					</div><!-- controls-->
			</div><!-- control-group-->

			<div class="control-group">
				<label class="control-label"><b>Tech</b> skills</label>
					<div class="controls">
						<select multiple="multiple" name="skills_TECH" class="input-xlarge" value="{{ pp['employee']['skills'] }}" id="skills_TECH">
							{% for skill in pp['skill_groups']['TECH'] %}
								<option {% if skill['id'] in pp['employee']['skills'] %} SELECTED {% endif %} value="{{ skill['id'] }}">{{ skill['name'] }}</option>
							{% endfor %}
						</select>
					</div><!-- controls -->
			</div><!-- control-group -->
			
			<div class="control-group">
				<label class="control-label"><b>Industry</b> skills</label>
					<div class="controls">
						<select multiple="multiple" name="skills_INDUSTRY" class="input-xlarge" value="{{ pp['employee']['skills'] }}" id="skills_INDUSTRY">
							{% for skill in pp['skill_groups']['INDUSTRY'] %}
								<option {% if skill['id'] in pp['employee']['skills'] %} SELECTED {% endif %} value="{{ skill['id'] }}">{{ skill['name'] }}</option>
							{% endfor %}
						</select>
					</div><!-- controls -->
			</div><!-- control-group -->
			
			<div class="control-group">
				<label class="control-label"><b>Human language</b> skills</label>
					<div class="controls">
						<select multiple="multiple" name="skills_HUMAN" class="input-xlarge" value="{{ pp['employee']['skills'] }}" id="skills_HUMAN">
							{% for skill in pp['skill_groups']['HUMAN LANG'] %}
								<option {% if skill['id'] in pp['employee']['skills'] %} SELECTED {% endif %} value="{{ skill['id'] }}">{{ skill['name'] }}</option>
							{% endfor %}
						</select>
					</div><!-- controls -->
					
			</div><!-- control-group -->	
			<div class="control-group">
				<label class="control-label"><b>Mongodb</b> skills</label>
					<div class="controls">
						<select multiple="multiple" name="skills_MONGO" class="input-xlarge" value="{{ pp['employee']['skills'] }}" id="skills_MONGO">
							{% for skill in pp['skill_groups']['MONGO'] %}
								<option {% if skill['id'] in pp['employee']['skills'] %} SELECTED {% endif %} value="{{ skill['id'] }}">{{ skill['name'] }}</option>
							{% endfor %}
						</select>
					</div><!-- controls -->
					
			</div><!-- control-group -->
			<div class="control-group">
				<label class="control-label"><b>Computer</b> language skills</label>
					<div class="controls">
						<select multiple="multiple" name="skills_COMP" class="input-xlarge" value="{{ pp['employee']['skills'] }}" id="skills_COMP">
							{% for skill in pp['skill_groups']['COMP LANG'] %}
								<option {% if skill['id'] in pp['employee']['skills'] %} SELECTED {% endif %} value="{{ skill['id'] }}">{{ skill['name'] }}</option>
							{% endfor %}
						</select>
					</div><!-- controls -->
			</div><!-- control-group -->			

		{% if pp['employee']['role'] == "manager" %}
			<div class="control-group">
				<label class="control-label">Managing</label>
					<div class="controls">
						<select multiple="multiple" class="input-xlarge" name="managing_ids" id="managing_ids">
						{% for member in pp['team_members'] %}
							<option value="{{ member._id }}" {% if member._id.__str__() in pp['employee']['managing_ids'] %} SELECTED {% endif %} >
								{{ member.first_name }} {{ member.last_name }}</option>
						{% endfor %}
						</select>
					</div><!-- controls -->
			</div><!-- control-group -->
		{% endif %}

		<div class="control-group">
			<label class="control-label">Team(s)</label>
				<div class="controls">
					<select multiple="multiple" class="input-xlarge" name="team_ids" id="team_ids">
					{% for team in pp['teams'] %}
						<option value="{{ team['_id'] }}" {% if team['_id'] in pp['employee']['team_ids'] %} SELECTED {% endif %} >
							{{ team['name'] }}</option>
					{% endfor %}
					</select>
				</div><!-- controls -->
		</div><!-- control-group -->
		
		<div class="control-group">
			<label class="control-label">Office</label>
				<div class="controls">
					<select name="office" class="input-xlarge" value="{{ pp['employee']['office'] }}" id="office">
						<option></option>
						{% for office in pp['offices'] %}
							<option {% if office == pp['employee']['office'] %} SELECTED {% endif %} >{{ office }}</option>
						{% endfor %}
					</select>
				</div><!-- controls-->
		</div><!-- controls-->

		<div class="control-group">
			<label class="control-label">Birthday</label>
				<div class="controls">
					<input type="text" class="input-xlarge" name="birthday" value="{{ pp['birthday'] }}" id="birthday">
				</div><!-- controls-->
		</div><!-- controls-->
						
		<div class="control-group">
			<label class="control-label">Start Date</label>
				<div class="controls">
					<input type="text" class="input-xlarge" name="start_date" value="{{ pp['start_date'] }}" id="start_date">
				</div><!-- controls-->
		</div><!-- controls-->

		<div class="control-group">
			<label class="control-label">Seat</label>
				<div class="controls">
					<input type="text" class="input-xlarge" name="seat" value="{{ pp['employee']['seat'] }}" id="seat">
				</div><!-- controls-->
		</div><!-- controls-->
		
		{% for n in pp['extra_fields'] %}
		<div class="control-group">
			<label class="control-label">{{n}}</label>
				<div class="controls">
					<input type="text" class="input-xlarge" name="{{n}}" value="{{ pp['employee'][n] }}" id="{{n}}">
				</div><!-- controls-->
		</div><!-- controls-->
		{% endfor %}
		
		<div class="control-group">
			<label class="control-label"></label>
				<div class="controls">
					<a style="float:right;margin-right:20px;" href="/employees/{{ pp['employee']['jira_uname']}}/newfield" id="new_field" >+ new field</a>
				</div><!-- controls-->
		</div><!-- controls-->

	</fieldset>
	<br/>
	<input type="submit" class ="btn btn-primary" style="float:right;margin:20px;">
</div><!-- span6 -->

</div>

</form>

<script type="text/javascript" charset="utf-8">
	jQuery(function($){
    	$('#employee_status').select2({
			allowClear: true,
			placeholder: "Select a status..."
			});
		$('#office').select2({
			allowClear: true,
			placeholder: "Select an office..."
		});
		$('#managing_ids').select2();
		$('#skills_TECH').select2();
		$('#skills_INDUSTRY').select2();
		$('#skills_HUMAN').select2();
		$('#skills_MONGO').select2();
 		$('#skills_COMP').select2();
    	$('#primary_phone_provider').select2({
			allowClear: true,
			placeholder: "Select a provider..."
			});
		$('#secondary_phone_provider').select2({
			allowClear: true,
			placeholder: "Select a provider..."
			});
		$('#team_ids').select2({
			placeholder: "Select a team..."
		});
	});
	
	$(document).ready(function() {
    $("#start_date").datepicker({dateFormat: 'dd-mm-yy' });
	$("#birthday").datepicker({dateFormat: 'dd-mm-yy' });
	$("a#edit_email").fancybox();
	$("a#edit_image").fancybox();
	$("a#new_field").fancybox();
  });
</script>

{% endblock %}